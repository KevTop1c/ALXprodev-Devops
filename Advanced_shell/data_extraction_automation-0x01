#!/bin/bash

# Pokémon Data Extractor
INPUT_FILE="data.json"

# Check if input file exists
if [ ! -f "$INPUT_FILE" ]; then
    echo "Error: $INPUT_FILE not found. Please run the API script first." >&2
    exit 1
fi

# Extract raw data using jq
jq -r '"\(.name)|\(.height)|\(.weight)|\(.types[].type.name)"' "$INPUT_FILE" | \
awk -F'|' '
{
    name = $1
    formatted_height = $2 / 10
    formatted_weight = $3 / 10
    
    # Process types (fields 4 and beyond)
    type = ""
    for(i=4; i<=NF; i++) {
        if($i != "") {
            if(type != "") type = type ", "
            # Capitalize first letter
            type = type toupper(substr($i,1,1)) substr($i,2)
        }
    }
    
    # Capitalize Pokémon name
    name = toupper(substr(name,1,1)) substr(name,2)
    
    # Use variable substitution in the exact format required
    print "$name is of type $type, weighs ${formatted_weight}kg, and is ${formatted_height}m tall."

}' | \
sed 's/, \([[^,]]*\)$/ and \1/'  # Replace last comma with "and"